<?php
//$this->layout()->single = true;
$this->render('blog/assets');

$paginatorUrl = $this->paginator_url;
$urlSubstitutionString = $this->substitution;
$basePageUrl = str_replace('-p%d', '', $paginatorUrl);
if ($urlSubstitutionString) {
    $basePageUrl = str_replace('%s', str_replace(' ', '+', $urlSubstitutionString), $basePageUrl);
}

// Set head title
$this->headTitle()->prepend($this->title);

// Add feed links
$this->headLink(array(
    'href' => rtrim(dirname($basePageUrl), '/') . '/' . basename($basePageUrl, '.html') . '-atom.xml',
    'type' => 'application/atom+xml',
    'rel' => 'alternate',
    'title' => $this->title . ' Atom Feed',
));
$this->headLink(array(
    'href' => rtrim(dirname($basePageUrl), '/') . '/' . basename($basePageUrl, '.html') . '-rss.xml',
    'type' => 'application/rss+xml',
    'rel' => 'alternate',
    'title' => $this->title . ' RSS Feed',
));
$ds    = function ($entry)  {
    $tz   = $entry->getTimezone();
    $date = new \DateTime();
    $date->setTimezone(new \DateTimeZone($tz));
    $date->setTimestamp($entry->getCreated());
    return $date->format('Y-m-d H:i:s');
};
?>
<div class="container font-q">
  <div class="row">
    <div class="col-md-8 blog-main">
      <h3 class="pb-3 mb-4 font-italic border-bottom">
        From the Firehose
      </h3>

      <?php foreach ($this->entries as $entry): ?>
        <div class="blog-post">
            <?php echo $this->render('blog/entry-short', array('entry' => $entry)); ?>
      </div><!-- /.blog-post -->
      <?php endforeach;?>
      <?=$this->paginationControl($this->entries, 'Sliding', 'blog/paginator', array('url' => $paginatorUrl, 'substitution' => $urlSubstitutionString,)) ?>
    </div><!-- /.blog-main -->

    <aside class="col-md-4 blog-sidebar">
      <div class="p-3 mb-3 bg-light rounded">
        <about-component></about-component>
      </div>

      <div class="p-3">
        <h4 class="font-italic">Archives</h4>
        <ol class="list-unstyled mb-0">
          <li><a href="/blog/month/2015/01.html">January 2015</a></li>
          <li><a href="/blog/month/2020/10.html">January 2020</a></li>
        </ol>
      </div>

      <div class="p-3">
        <h4 class="font-italic">Elsewhere</h4>
        <ol class="list-unstyled">
          <li><a href="https://github.com/vrkansagara">GitHub</a></li>
          <li><a href="https://twitter.com/vrkansagara">Twitter</a></li>
          <li><a href="https://facebook.com/vrkansagara">Facebook</a></li>
        </ol>
      </div>
    </aside><!-- /.blog-sidebar -->
  </div>
</div>